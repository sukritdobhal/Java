-------------------------JOB 1----------------------------DDL-----------------------


DECLARE 
 V_START_DATE TIMESTAMP WITH TIME ZONE;
BEGIN 

SELECT LOCALTIMESTAMP AT TIME ZONE 'US/EASTERN' INTO V_START_DATE FROM DUAL; --US/EASTERN

EXECUTE IMMEDIATE 'ALTER SESSION SET CURRENT_SCHEMA = DBXNET';
EXECUTE IMMEDIATE Q'[ALTER SESSION SET NLS_TIMESTAMP_TZ_FORMAT = 'MM-DD-YYYY HH24:MI:SS TZR TZD']';
 
   DBMS_SCHEDULER.CREATE_JOB ( 
    JOB_NAME => 'POPULATE_CR_MAIN', 
    JOB_TYPE => 'PLSQL_BLOCK', 
    JOB_ACTION => 'DECLARE BEGIN DBXNET.CREDIT_RECEIVABLES.POPULATE_CR(); END;', 
    START_DATE => V_START_DATE, 
    ENABLED => TRUE, 
    REPEAT_INTERVAL => 'FREQ=DAILY; BYHOUR=21; BYMINUTE=00; BYSECOND=0;'
   ); 
   
END;

--------------------------------------------JOB 2 DDL------------------------------------------------------------------------------


DECLARE 
 V_START_DATE TIMESTAMP WITH TIME ZONE;
BEGIN 

SELECT LOCALTIMESTAMP AT TIME ZONE 'US/EASTERN' INTO V_START_DATE FROM DUAL; --US/EASTERN

EXECUTE IMMEDIATE 'ALTER SESSION SET CURRENT_SCHEMA = DBXNET';
EXECUTE IMMEDIATE Q'[ALTER SESSION SET NLS_TIMESTAMP_TZ_FORMAT = 'MM-DD-YYYY HH24:MI:SS TZR TZD']';
 
   DBMS_SCHEDULER.CREATE_JOB ( 
    JOB_NAME => 'POPULATE_CR_BACK', 
    JOB_TYPE => 'PLSQL_BLOCK', 
    JOB_ACTION => 'DECLARE BEGIN DBXNET.CREDIT_RECEIVABLES.POPULATE_CR_BACK_UP(); END;', 
    START_DATE => V_START_DATE, 
    ENABLED => TRUE, 
    REPEAT_INTERVAL => 'FREQ=DAILY; BYHOUR=20; BYMINUTE=00; BYSECOND=0;'
   ); 
   
END;
-----------------------------------------------------------------------------------------------------------------------------------------
DECLARE 
 V_START_DATE TIMESTAMP WITH TIME ZONE;
BEGIN 

SELECT LOCALTIMESTAMP AT TIME ZONE 'US/EASTERN' INTO V_START_DATE FROM DUAL; --US/EASTERN

EXECUTE IMMEDIATE 'ALTER SESSION SET CURRENT_SCHEMA = DBXNET';
EXECUTE IMMEDIATE Q'[ALTER SESSION SET NLS_TIMESTAMP_TZ_FORMAT = 'MM-DD-YYYY HH24:MI:SS TZR TZD']';
 
   DBMS_SCHEDULER.CREATE_JOB ( 
    JOB_NAME => 'DEL_SLBK', 
    JOB_TYPE => 'PLSQL_BLOCK', 
    JOB_ACTION => 'BEGIN DBXNET.DEL_SLBK_D(); END;', 
    START_DATE => V_START_DATE, 
    ENABLED => TRUE, 
    REPEAT_INTERVAL => 'FREQ=DAILY; BYHOUR=00; BYMINUTE=00; BYSECOND=0;'
   ); 
END;
------------------------------------------------------------------------------------------------------------------------------------------------
 
