--------------------------BRAND UPDATE---------------------------------
CREATE TABLE DBXNET.BRAND_UPDATE (Market_Sector_Key VARCHAR2 (10), DESCRIPTION VARCHAR2(500), BRAND NUMBER(3,0));

SELECT * FROM DBXNET.BRAND_UPDATE;

UPDATE DBXNET.BRAND_UPDATE SET Market_Sector_Key = TRIM(Market_Sector_Key), DESCRIPTION = TRIM(DESCRIPTION), BRAND = TRIM(BRAND);


SELECT BRA_SL, LISTUNG FROM DBXNET.DFZG_D WHERE BRA_SL IN (SELECT MARKET_SECTOR_KEY FROM DBXNET.BRAND_UPDATE);

SELECT *  FROM DBXNET.BRAND_UPDATE where MARKET_SECTOR_KEY in (SELECT BRA_SL FROM DBXNET.DFZG_D);


SELECT DISTINCT(BRA_SL) FROM DBXNET.DFZG_D
MINUS
SELECT DISTINCT(MARKET_SECTOR_KEY) FROM DBXNET.BRAND_UPDATE;

SET SERVEROUTPUT ON
DECLARE
L NUMBER := 0;
BEGIN
FOR I IN (SELECT MARKET_SECTOR_KEY, BRAND FROM DBXNET.BRAND_UPDATE)
LOOP
UPDATE DBXNET.DFZG_D SET BRA_SL = I.BRAND WHERE TRIM(BRA_SL) = TRIM(I.MARKET_SECTOR_KEY);
L := L + SQL%ROWCOUNT;
END LOOP;
DBMS_OUTPUT.PUT_LINE(L);
END;

------------------------------------------------------------------------------------------------------------------------------------

SELECT BRA_SL, LISTUNG FROM DBXNET.DFZG_D WHERE BRA_SL IN (SELECT MARKET_SECTOR_KEY FROM DBXNET.BRAND_UPDATE);

SELECT B.BRA_SL, A.BRAND  FROM DBXNET.BRAND_UPDATE A  INNER JOIN DBXNET.DFZG_D B ON TRIM(A.BRAND) = TRIM(B.BRA_SL);
-------------------------------------------------------------------------------------------------------------------------------------


