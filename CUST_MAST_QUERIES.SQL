SELECT * FROM DBXNET.NEWSAPCUST_KTO_MAP WHERE SAP_CUST_NUMBER IN (
SELECT SAP_CUST_NUMBER  FROM DBXNET.KD01_D WHERE SAP_CUST_NUMBER IS NOT NULL AND KDGR IS NULL) AND KDGR IS NOT NULL;


--0000005300

SELECT * FROM DBXNET.NEWSAPCUST_KTO_MAP WHERE SAP_CUST_NUMBER = '0000005300';

SELECT KDGR  FROM DBXNET.KD01_D WHERE SAP_CUST_NUMBER = '0001359675';


--IS NOT  NULL; -- 7157

SELECT COUNT(*)  FROM DBXNET.SAPCUST_KTO_MAP WHERE SAP_CUST_NUMBER IS NOT  NULL;--16097

SELECT COUNT(DISTINCT(SAP_CUST_NUMBER))  FROM DBXNET.NEWSAPCUST_KTO_MAP WHERE SAP_CUST_NUMBER IN
(SELECT DISTINCT(SAP_CUST_NUMBER) FROM DBXNET.KD01_D WHERE SAP_CUST_NUMBER IS NOT NULL); --6910

SELECT DISTINCT(SAP_CUST_NUMBER) FROM DBXNET.KD01_D WHERE SAP_CUST_NUMBER IS NOT NULL
MINUS
SELECT DISTINCT(SAP_CUST_NUMBER) FROM DBXNET.NEWSAPCUST_KTO_MAP WHERE SAP_CUST_NUMBER IS NOT NULL;

SELECT COUNT(SAP_CUST_NUMBER) FROM DBXNET.KD01_D; -- 7156
--WHERE SAP_CUST_NUMBER IS  NULL;----7156

SELECT SAP_CUST_NUMBER FROM DBXNET.KD01_D GROUP BY SAP_CUST_NUMBER HAVING COUNT(SAP_CUST_NUMBER) >1;

SELECT ORDAT_SEQUENCE FROM DBXNET.KD01_D WHERE SAP_CUST_NUMBER = '0001030676';

DELETE FROM DBXNET.KD01_D WHERE ORDAT_SEQUENCE = 694403;

SELECT COUNT(SAP_CUST_NUMBER) FROM DBXNET.NEWSAPCUST_KTO_MAP; -- 7112

SELECT COUNT(SAP_CUST_NUMBER) FROM DBXNET.SAPCUST_KTO_MAP;

SELECT * FROM DBXNET.SAPVERT_MAP;


SELECT * FROM  DBXNET.NEWSAPCUST_KTO_MAP;
DESCRIBE DBXNET.SAPVERT_MAP;
--- 16097

SELECT KDGR FROM DBAUFT.KD01_D WHERE VERT_NR IN (SELECT VERT_NR FROM  DBXNET.SAPVERT_MAP);

SELECT * FROM DBAUFT.KD01_D WHERE KTO_NR LIKE '9%';

SELECT * FROM ALL_TABLES WHERE TABLE_NAME = 'VERT_NR';


SELECT KDGR FROM DBAUFT.KD01_D WHERE FA_KTO_NR IN (
SELECT FA_KTO_NR FROM DBFBIN.PERSAD_D WHERE KTO_NR = 90000004);


SELECT SAP_CUST_NUMBER, KDGR FROM DBXNET.KD01_D WHERE
SAP_CUST_NUMBER IN (SELECT SAP_CUST_NUMBER FROM DBXNET.PERSAD_D WHERE TRIM(PERS_KZ) = 'KU') AND KDGR IS NULL;

SELECT FA_KTO_NR, KDGR FROM DBAUFT.KD01_D WHERE FA_KTO_NR IN (
SELECT FA_KTO_NR FROM DBXNET.NEWSAPCUST_KTO_MAP M WHERE  M.SAP_CUST_NUMBER IN (
SELECT SAP_CUST_NUMBER FROM DBXNET.KD01_D D WHERE
D.SAP_CUST_NUMBER IN (SELECT SAP_CUST_NUMBER FROM DBXNET.PERSAD_D WHERE TRIM(PERS_KZ) = 'KU') AND D.KDGR IS NULL));


SELECT FA_KTO_NR FROM DBXNET.NEWSAPCUST_KTO_MAP M WHERE  M.SAP_CUST_NUMBER IN (
SELECT SAP_CUST_NUMBER FROM DBXNET.KD01_D D WHERE
D.SAP_CUST_NUMBER IN (SELECT SAP_CUST_NUMBER FROM DBXNET.PERSAD_D WHERE TRIM(PERS_KZ) = 'KU') AND D.KDGR IS NULL);


--FR    35400329

SELECT * FROM DBAUFT.KD01_D WHERE KTO_NR = 35400329;


SELECT FA_KTO_NR FROM DBXNET.NEWSAPCUST_KTO_MAP
MINUS
SELECT FA_KTO_NR FROM DBAUFT.KD01_D;


SELECT * FROM DBXNET.NEWSAPCUST_KTO_MAP WHERE FA_KTO_NR IS NULL;

 UPDATE DBXNET.NEWSAPCUST_KTO_MAP SET FA_KTO_NR = TRIM(FOSS_SALES_ORG)||' '||' '||' ' ||' '||KTO_NR WHERE TRIM(FOSS_SALES_ORG) <> 'GUTB';
 --------------------------------------------------------------------------------------------------------------------------------------------------
 UPDATE DBXNET.NEWSAPCUST_KTO_MAP SET FA_KTO_NR = TRIM(FOSS_SALES_ORG)||' '||' '||KTO_NR WHERE TRIM(FOSS_SALES_ORG) = 'GUTB';





SELECT * FROM DBXNET.PERSAD_D; -- KU 




SELECT FA_KTO_NR, KDGR FROM DBAUFT.KD01_D WHERE VERT_NR IS NULL;





SELECT * FROM DBXNET.SAPCUST_KTO_MAP WHERE SAP_CUST_NUMBER IN (
SELECT distinct(SAP_CUST_NUMBER) FROM DBXNET.KD01_D WHERE sap_cust_number is NOT null
minus
SELECT distinct(SAP_CUST_NUMBER) FROM DBXNET.newSAPCUST_KTO_MAP WHERE sap_cust_number is NOT null);








--AND KDGR IS NULL

SELECT SAP_CUST_NUMBER, KDGR, VERT_NR  FROM DBXNET.KD01_D WHERE SAP_CUST_NUMBER IS NOT NULL AND KDGR IS NULL

SELECT * FROM DBXNET.ULI_M WHERE UPPER(TRIM(MAILADRESSE))  LIKE '%WILLIAN%';

SELECT * FROM DBXNET.ULI_M WHERE KTO_NR = 35074787;

SELECT SAP_CUST_NUMBER, SALES_ORG, SAP_VERT_NR, STATUS_KZ, BER_GRP FROM DBXNET.ULI_M  WHERE SAP_CUST_NUMBER IN (
SELECT SAP_CUST_NUMBER FROM DBXNET.NEWSAPCUST_KTO_MAP WHERE KTO_NR = 35074787);

SELECT * FROM DBXNET.ULI_M WHERE TRIM(BENUTZER)  = 'ServiceBMB';

SELECT * FROM DBXNET.PERSAD_D WHERE SAP_CUST_NUMBER  = '0001363105';
SELECT * FROM DBXNET.ULI_M WHERE BER_GRP = 'AX';
--0001317842

SELECT * FROM DBXNET.ULI_M WHERE SAP_CUST_NUMBER = '0001328224';

UPDATE DBXNET.ULI_M SET SAP_CUST_NUMBER  = '30999900', SALES_ORG = 'DE01', SAP_VERT_NR = '0', STATUS_KZ = 0, BER_GRP = 'T'
WHERE TRIM(BENUTZER)  = 'ServiceBMB';

UPDATE DBXNET.ULI_M SET  SAP_VERT_NR = '0', STATUS_KZ = 0
WHERE SAP_CUST_NUMBER = '0001334069';

SELECT LIMIT_1, CREDIT_STATUS FROM DBXNET.PERSAD_D;
--WHERE LIMIT_1 =0  AND CREDIT_STATUS = '0';

SELECT * FROM DBXNET.ULI_M WHERE  TRIM(BENUTZER)  = 'JOERN';

SELECT count(*) FROM DBXNET.PERSAD_D WHERE LIMIT_1 is null   AND CREDIT_STATUS is null;

SELECT BENUTZER, SAP_VERT_NR, SALES_ORG FROM DBXNET.ULI_M WHERE SAP_VERT_NR IN (
'60ITA3K',
'60ITA3O',
'60ITA2Y',
'60ITA3M',
'60ITA2R',
'60ITA2S',
'60ITA2T',
'60ITA2U',
'60ITA3D',
'60ITA3N',
'60ITA2W',
'60ITA2X',
'60ITA3L',
'60ITA3J');



SELECT SAP_CUST_NUMBER, LIMIT_1, CREDIT_STATUS  FROM DBXNET.PERSAD_D WHERE SAP_CUST_NUMBER IN (
SELECT SAP_CUST_NUMBER FROM DBXNET.KD01_D WHERE VERT_NR = 'DEMTD061');
